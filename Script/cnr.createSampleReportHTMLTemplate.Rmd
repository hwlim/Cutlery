---
title: | 
    | 
    | 
    | `r paste("Group:", groupName, sep = "  ")`
    | `r paste("Sample:", sampleName)`
date: "`r Sys.Date()`"
output:
    html_document:
    df_print: kable
---

<style type="text/css">
h1.title {
  font-size: 22px;
  color: Black;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE}
htmltools::img(src = knitr::image_uri(tempLogo), 
               alt = 'logo', 
               style = 'position:absolute; top:0; right:1; padding:1px;')
```

# {.tabset}

## Alignment Statistics {.tabset}
\
```{r insert-tables, echo=FALSE, message=FALSE, warning=FALSE}
	alnStatFile <- read.table(paste0(qcDir, "/alignStat.txt"), sep="	", header=T, check.names = FALSE)
	alnStat <- alnStatFile[which(alnStatFile$Sample == sampleName), ]
	colnames(alnStat) <- c("Sample", "Total Fragments", "Uniquely Aligned", "Multi-Aligned", "% Uniquely Aligned", "% Multi-Aligned", "% Too Many Multi-Aligned", "% Mismatch", "% Too Short", "% Other")
	rownames(alnStat) <- c()
	kable(format(alnStat, big.mark=",", scientific=FALSE), align="lrrrrrrrrr") %>%
	kable_styling(full_width = T, bootstrap_options = "bordered") %>%
	row_spec(0, align = "c", extra_css = 'vertical-align: middle !important;') %>%
	column_spec(1, bold = T)
```

## Fragment Library Complexity {.tabset}
\
```{r, echo=FALSE, message=FALSE, warning=FALSE}
	uniqCntFile <-read.table(paste0(qcDir, "/uniqFragCnt.txt"), sep="\t", header=T)
	uniqCnt <- uniqCntFile[which(uniqCntFile$Name == sampleName), ]
	colnames(uniqCnt) <- c("Sample","Total Fragments (Filtered)","Unique Fragments","% Unique Fragments")
	rownames(uniqCnt) <- c()
	kable(format(uniqCnt, big.mark=",", scientific=FALSE), align="lrrr") %>%
	kable_styling(full_width = T, bootstrap_options = "bordered") %>%
	row_spec(0, align = "c", extra_css = 'vertical-align: middle !important;') %>%
	column_spec(1, bold = T)
```

## Base Frequencies {.tabset}
\
```{r insert-base-freq, echo=FALSE, out.width="100%", message=FALSE, warning=FALSE}
	knitr::include_graphics(baseFreq)
```

## Fragment Distribution {.tabset}
\
```{r insert-fragQC-table, echo=FALSE, message=FALSE, warning=FALSE}
	colnames(fragQCtable) <- c("Sample","Peak Mode","NFR Frags (%)","NUC Frags (%)","W~0~", "W~1~", "W~2~")
	kable(format(fragQCtable, big.mark=",", scientific=FALSE), align="llrrrrr") %>%
	kable_styling(full_width = T, bootstrap_options = "bordered") %>%
	row_spec(0, align = "c", extra_css = 'vertical-align: middle !important;') %>%
	column_spec(1, bold = T)
```
\
```{r frag-dist, echo=FALSE, out.width='100%', fig.align="center", message=FALSE, warning=FALSE}
	knitr::include_graphics(fragLenDist)
```

## Peak Examples {.tabset}
\
```{r peak-counts-TF, echo=FALSE, message=FALSE, warning=FALSE}
	if (nrow(factorTable) != 0) {
		colnames(factorTable) <- c("Sample","Number of Peaks","% of Fragments overlapping with a peak")
		kable(format(factorTable, big.mark=",", scientific=FALSE), align="lrr") %>%
		kable_styling(full_width = T, bootstrap_options = "bordered") %>%
		row_spec(0, align = "c") %>%
		column_spec(1, bold = T)
	}

```

\
```{r peak-counts-hist, echo=FALSE, message=FALSE, warning=FALSE}
	if (nrow(histoneTable) != 0) {
		colnames(histoneTable) <- c("Sample","Number of Peaks","Total Peak Width (bp)","% of Fragments overlapping with a peak")
		kable(format(histoneTable, big.mark=",", scientific=FALSE), align="lrrr") %>%
		kable_styling(full_width = T, bootstrap_options = "bordered") %>%
		row_spec(0, align = "c") %>%
		column_spec(1, bold = T)
	}

```
\
```{r peak-example, echo=FALSE, out.width='100%', fig.align="center", message=FALSE, warning=FALSE}
	knitr::include_graphics(peakExamplePlot)
```
\
```{r peak-heatmap, echo=FALSE, out.width='70%', fig.align="center", message=FALSE, warning=FALSE}
	knitr::include_graphics(heatmap)
```